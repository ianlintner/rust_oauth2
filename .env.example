# Example environment configuration for rust_oauth2_server
# Copy to `.env` and adjust values for local development.

# Server
OAUTH2_SERVER_HOST=127.0.0.1
OAUTH2_SERVER_PORT=8080

# Storage backend selection (URL scheme decides backend)
# - SQLite (default): sqlite:oauth2.db
# - PostgreSQL:       postgresql://user:pass@localhost:5432/oauth2
# - MongoDB:          mongodb://localhost:27017/oauth2   (requires building with: --features mongo)
OAUTH2_DATABASE_URL=sqlite:oauth2.db

# Security
# NOTE: Must be >= 32 chars. Use a random value in real deployments.
OAUTH2_JWT_SECRET=change-me-to-a-random-32+-char-secret

# Observability
# Prometheus is scraped from the server's /metrics endpoint.
# For tracing, you can point directly at Jaeger OTLP gRPC (4317) or at an OpenTelemetry Collector.

# Back-compat with this repo's docs; the app will map this to OTEL_EXPORTER_OTLP_ENDPOINT if needed.
OAUTH2_OTLP_ENDPOINT=

# Standard OpenTelemetry env vars (preferred)
OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_EXPORTER_OTLP_PROTOCOL=grpc
OTEL_SERVICE_NAME=oauth2_server

# Logging
RUST_LOG=info

# Eventing
# Backends:
# - in_memory (default)
# - console
# - both
# - redis / redis_streams (requires: --features events-redis)
# - kafka (requires: --features events-kafka)
# - rabbit / rabbitmq (requires: --features events-rabbit)
OAUTH2_EVENTS_ENABLED=true
OAUTH2_EVENTS_BACKEND=in_memory

# Filtering
# - allow_all (default)
# - include
# - exclude
OAUTH2_EVENTS_FILTER_MODE=allow_all
# Comma-separated list of event types (only used for include/exclude)
OAUTH2_EVENTS_TYPES=

# Redis Streams backend settings
OAUTH2_EVENTS_REDIS_URL=redis://127.0.0.1:6379
OAUTH2_EVENTS_REDIS_STREAM=oauth2_events
# Approximate MAXLEN (~). Leave blank for unlimited.
OAUTH2_EVENTS_REDIS_MAXLEN=

# Kafka backend settings
OAUTH2_EVENTS_KAFKA_BROKERS=127.0.0.1:9092
OAUTH2_EVENTS_KAFKA_TOPIC=oauth2_events
OAUTH2_EVENTS_KAFKA_CLIENT_ID=

# RabbitMQ backend settings
OAUTH2_EVENTS_RABBIT_URL=amqp://127.0.0.1:5672/%2f
OAUTH2_EVENTS_RABBIT_EXCHANGE=oauth2.events
OAUTH2_EVENTS_RABBIT_ROUTING_KEY=oauth2.event
