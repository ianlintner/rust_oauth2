# OAuth2 Server Configuration
# This is a HOCON (Human-Optimized Config Object Notation) configuration file
# See: https://github.com/lightbend/config/blob/master/HOCON.md
#
# Environment variables can be used with ${?VARIABLE_NAME} syntax
# Values can be overridden by setting environment variables with OAUTH2_ prefix

# Server Configuration
server {
  # Server host binding
  host = "127.0.0.1"
  host = ${?OAUTH2_SERVER_HOST}
  
  # Server port
  port = 8080
  port = ${?OAUTH2_SERVER_PORT}
}

# Database Configuration
database {
  # Database URL - supports SQLite, PostgreSQL, and MongoDB (with --features mongo)
  # Examples:
  #   - SQLite:     sqlite:oauth2.db
  #   - PostgreSQL: postgresql://user:pass@localhost:5432/oauth2
  #   - MongoDB:    mongodb://localhost:27017/oauth2
  url = "sqlite:oauth2.db"
  url = ${?OAUTH2_DATABASE_URL}
}

# JWT Configuration
jwt {
  # JWT signing secret - MUST be set for production (minimum 32 characters)
  # Generate with: openssl rand -base64 48
  secret = "insecure-default-for-testing-only-change-in-production"
  secret = ${?OAUTH2_JWT_SECRET}
}

# Event System Configuration
events {
  # Enable/disable event system
  enabled = true
  enabled = ${?OAUTH2_EVENTS_ENABLED}
  
  # Event backend selection
  # Options: in_memory, console, both, redis, redis_streams, kafka, rabbit, rabbitmq
  backend = "in_memory"
  backend = ${?OAUTH2_EVENTS_BACKEND}
  
  # Event filtering mode
  # Options: allow_all, include, exclude
  filter_mode = "allow_all"
  filter_mode = ${?OAUTH2_EVENTS_FILTER_MODE}
  
  # Event types - set via OAUTH2_EVENTS_TYPES environment variable (comma-separated)
  # Example: OAUTH2_EVENTS_TYPES="token_created,token_revoked"
  
  # Redis Streams Backend Configuration
  redis {
    url = "redis://127.0.0.1:6379"
    url = ${?OAUTH2_EVENTS_REDIS_URL}
    
    stream = "oauth2_events"
    stream = ${?OAUTH2_EVENTS_REDIS_STREAM}
    
    # Max length (approximate MAXLEN ~). Leave empty for unlimited
    maxlen = null
    maxlen = ${?OAUTH2_EVENTS_REDIS_MAXLEN}
  }
  
  # Kafka Backend Configuration
  kafka {
    brokers = "127.0.0.1:9092"
    brokers = ${?OAUTH2_EVENTS_KAFKA_BROKERS}
    
    topic = "oauth2_events"
    topic = ${?OAUTH2_EVENTS_KAFKA_TOPIC}
    
    client_id = null
    client_id = ${?OAUTH2_EVENTS_KAFKA_CLIENT_ID}
  }
  
  # RabbitMQ Backend Configuration
  rabbit {
    url = "amqp://127.0.0.1:5672/%2f"
    url = ${?OAUTH2_EVENTS_RABBIT_URL}
    
    exchange = "oauth2.events"
    exchange = ${?OAUTH2_EVENTS_RABBIT_EXCHANGE}
    
    routing_key = "oauth2.event"
    routing_key = ${?OAUTH2_EVENTS_RABBIT_ROUTING_KEY}
  }
}

# Social Login Configuration
# Configure OAuth2 providers for social login
# Only configure providers you want to enable by setting their environment variables
social {
  # Google OAuth2 - set OAUTH2_GOOGLE_CLIENT_ID, OAUTH2_GOOGLE_CLIENT_SECRET, OAUTH2_GOOGLE_REDIRECT_URI
  google {
    enabled = false
  }
  
  # Microsoft OAuth2 - set OAUTH2_MICROSOFT_CLIENT_ID, OAUTH2_MICROSOFT_CLIENT_SECRET, OAUTH2_MICROSOFT_REDIRECT_URI
  microsoft {
    enabled = false
  }
  
  # GitHub OAuth2 - set OAUTH2_GITHUB_CLIENT_ID, OAUTH2_GITHUB_CLIENT_SECRET, OAUTH2_GITHUB_REDIRECT_URI
  github {
    enabled = false
  }
  
  # Azure OAuth2 (uses Microsoft endpoint) - set OAUTH2_AZURE_CLIENT_ID, OAUTH2_AZURE_CLIENT_SECRET, OAUTH2_AZURE_REDIRECT_URI
  azure {
    enabled = false
  }
  
  # Okta OAuth2 - set OAUTH2_OKTA_CLIENT_ID, OAUTH2_OKTA_CLIENT_SECRET, OAUTH2_OKTA_REDIRECT_URI, OAUTH2_OKTA_DOMAIN
  okta {
    enabled = false
  }
  
  # Auth0 OAuth2 - set OAUTH2_AUTH0_CLIENT_ID, OAUTH2_AUTH0_CLIENT_SECRET, OAUTH2_AUTH0_REDIRECT_URI, OAUTH2_AUTH0_DOMAIN
  auth0 {
    enabled = false
  }
}

# Session Configuration
session {
  # Session key (must be at least 64 characters / 128 hex digits)
  # Generate with: openssl rand -hex 64
  key = ${?OAUTH2_SESSION_KEY}
}

# Debug Configuration
debug {
  # Enable debug config logging (set to "1" to enable)
  config = ${?OAUTH2_DEBUG_CONFIG}
}
